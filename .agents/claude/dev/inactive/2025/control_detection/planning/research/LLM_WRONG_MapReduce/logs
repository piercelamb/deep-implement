Starting full aggregation...

############################################################
STARTING MAP-REDUCE AGGREGATION
############################################################
  Initial items: 22 policies
############################################################

============================================================
ROUND 1 START
============================================================
  Items: 22
  Pairs to process: 11 (max_parallel=3, effective=3)
  Total Universal Rules: 0
  Total Rare Rules: 0
  TOTAL RULES: 0
============================================================
  >>> Round 1 Pair 1/11 complete: [0U+0R] + [0U+0R] = 0 in -> 0U + 5R = 5 out (reduced by 0, 0.0%)
  >>> Round 1 Pair 2/11 complete: [0U+0R] + [0U+0R] = 0 in -> 0U + 7R = 7 out (reduced by 0, 0.0%)
  >>> Round 1 Pair 3/11 complete: [0U+0R] + [0U+0R] = 0 in -> 0U + 6R = 6 out (reduced by 0, 0.0%)
  >>> Round 1 Pair 4/11 complete: [0U+0R] + [0U+0R] = 0 in -> 0U + 4R = 4 out (reduced by 0, 0.0%)
  >>> Round 1 Pair 5/11 complete: [0U+0R] + [0U+0R] = 0 in -> 0U + 3R = 3 out (reduced by 0, 0.0%)
  >>> Round 1 Pair 6/11 complete: [0U+0R] + [0U+0R] = 0 in -> 0U + 7R = 7 out (reduced by 0, 0.0%)
  >>> Round 1 Pair 7/11 complete: [0U+0R] + [0U+0R] = 0 in -> 0U + 4R = 4 out (reduced by 0, 0.0%)
  >>> Round 1 Pair 8/11 complete: [0U+0R] + [0U+0R] = 0 in -> 0U + 6R = 6 out (reduced by 0, 0.0%)
  >>> Round 1 Pair 9/11 complete: [0U+0R] + [0U+0R] = 0 in -> 0U + 2R = 2 out (reduced by 0, 0.0%)
  >>> Round 1 Pair 10/11 complete: [0U+0R] + [0U+0R] = 0 in -> 0U + 6R = 6 out (reduced by 0, 0.0%)
  >>> Round 1 Pair 11/11 complete: [0U+0R] + [0U+0R] = 0 in -> 0U + 5R = 5 out (reduced by 0, 0.0%)

============================================================
ROUND 1 COMPLETE
============================================================
  Items: 11
  Total Universal Rules: 0
  Total Rare Rules: 55
  TOTAL RULES: 55
============================================================

============================================================
ROUND 2 START
============================================================
  Items: 11
  Pairs to process: 6 (max_parallel=3, effective=3)
  Total Universal Rules: 0
  Total Rare Rules: 55
  TOTAL RULES: 55
============================================================
  >>> Round 2 Pair 1/6 complete: [0U+5R] + [0U+3R] = 8 in -> 1U + 6R = 7 out (reduced by 1, 12.5%)
  >>> Round 2 Pair 2/6 complete: [0U+6R] + [0U+7R] = 13 in -> 1U + 11R = 12 out (reduced by 1, 7.7%)
  >>> Round 2 Pair 3/6 complete: [0U+7R] + [0U+4R] = 11 in -> 2U + 7R = 9 out (reduced by 2, 18.2%)
  >>> Round 2 Pair 4/6 complete: SOLO passthrough [0U + 5R = 5 rules]
  >>> Round 2 Pair 5/6 complete: [0U+6R] + [0U+2R] = 8 in -> 2U + 4R = 6 out (reduced by 2, 25.0%)
  >>> Round 2 Pair 6/6 complete: [0U+4R] + [0U+6R] = 10 in -> 1U + 8R = 9 out (reduced by 1, 10.0%)

============================================================
ROUND 2 COMPLETE
============================================================
  Items: 6
  Total Universal Rules: 7
  Total Rare Rules: 41
  TOTAL RULES: 48
============================================================

============================================================
ROUND 3 START
============================================================
  Items: 6
  Pairs to process: 3 (max_parallel=3, effective=3)
  Total Universal Rules: 7
  Total Rare Rules: 41
  TOTAL RULES: 48
============================================================
  >>> Round 3 Pair 1/3 complete: [2U+4R] + [0U+5R] = 11 in -> 3U + 7R = 10 out (reduced by 1, 9.1%)
  >>> Round 3 Pair 2/3 complete: [2U+7R] + [1U+8R] = 18 in -> 7U + 7R = 14 out (reduced by 4, 22.2%)
  >>> Round 3 Pair 3/3 complete: [1U+11R] + [1U+6R] = 19 in -> 5U + 7R = 12 out (reduced by 7, 36.8%)

============================================================
ROUND 3 COMPLETE
============================================================
  Items: 3
  Total Universal Rules: 15
  Total Rare Rules: 21
  TOTAL RULES: 36
============================================================

============================================================
ROUND 4 START
============================================================
  Items: 3
  Pairs to process: 2 (max_parallel=3, effective=2)
  Total Universal Rules: 15
  Total Rare Rules: 21
  TOTAL RULES: 36
============================================================
  >>> Round 4 Pair 1/2 complete: SOLO passthrough [3U + 7R = 10 rules]
  >>> Round 4 Pair 2/2 complete: [5U+7R] + [7U+7R] = 26 in -> 10U + 9R = 19 out (reduced by 7, 26.9%)

============================================================
ROUND 4 COMPLETE
============================================================
  Items: 2
  Total Universal Rules: 13
  Total Rare Rules: 16
  TOTAL RULES: 29
============================================================

============================================================
ROUND 5 START
============================================================
  Items: 2
  Pairs to process: 1 (max_parallel=3, effective=1)
  Total Universal Rules: 13
  Total Rare Rules: 16
  TOTAL RULES: 29
============================================================
  >>> Round 5 Pair 1/1 complete: [10U+9R] + [3U+7R] = 29 in -> 11U + 12R = 23 out (reduced by 6, 20.7%)

============================================================
ROUND 5 COMPLETE
============================================================
  Items: 1
  Total Universal Rules: 11
  Total Rare Rules: 12
  TOTAL RULES: 23
============================================================

############################################################
AGGREGATION COMPLETE
############################################################
  Total Rounds: 5
  Final Universal Rules: 11
  Final Rare Rules: 12
  TOTAL FINAL RULES: 23
  Source Policies: 22
############################################################
Aggregation complete!
Final output: /Users/plamb/Drata/ai-services/ai_services/scripts/experiments/control_detection/files/experiments/template_policies/aggregated_patterns/final_output.json
Universal rules: 11
Rare rules: 12
Total decision rules: 23
Source policies: 22